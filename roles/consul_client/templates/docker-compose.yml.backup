consul:
    image: gliderlabs/consul:0.6
    restart: always
    ports:
    - "{{ private_ip }}:8300:8300"
    - "{{ private_ip }}:8301:8301"
    - "{{ private_ip }}:8301:8301/udp"
    - "{{ private_ip }}:8302:8302"
    - "{{ private_ip }}:8302:8302/udp"
    - "{{ private_ip }}:8400:8400"
    - "{{ private_ip }}:8500:8500"
    - "{{ docker_bridge_ip }}:53:53/udp"
    volumes:
    - /srv/consul:/data
    command: agent -server -rejoin -advertise "{{ private_ip }}" -join "{{ jupyterhub_host }}" -data-dir=/data


swarm:
    image: swarm
    restart: always
    command: join --addr "{{ private_ip}}:2375" "consul://{{ jupyterhub_host }}:8500/swarm"
    ports:
      - 2375:2375
